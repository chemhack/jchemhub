<!DOCTYPE html>
<!--TODO: License and copyright-->
<html>
<head>
<title>jchemhub unit test-geometry.js</title>
<script src="../../closure/goog/base.js"></script>
<script src="../core/core.js"></script>
<script src="../io/io.js"></script>
<script src="../io/io_test_molsample.js"></script>
<script src="geometry.js"></script>
<script>
	goog.require('goog.testing.jsunit');
</script>
<script>
	var mol;
 	var sdfs;
  	function setUp() {
		sdfs = sdf.split("$$$$\n");
		mol=chem.io.Molfile.read(sdfs[3]);
   	}


	function testGetCenter() {
		var center=chem.render.Geometry.getGeometryCenter(mol);
		assertRoughlyEquals(8.03,center.x,0.01);
		assertRoughlyEquals(7.60,center.y,0.01);
	}
	function testGetMinMax() {
		var minMax=chem.render.Geometry.getMinMax(mol);
	/*	
		console.debug("maxX:"+minMax.maxX);
		console.debug("minX:"+minMax.minX);
		console.debug("maxY:"+minMax.maxY);
		console.debug("minY:"+minMax.minY);
	*/
	  	assertRoughlyEquals(12.8978,minMax.maxX,0.01);
	  	assertRoughlyEquals(4.387,minMax.minX,0.01);
	  	assertRoughlyEquals(13.0496,minMax.maxY,0.01);
	  	assertRoughlyEquals(3.2325,minMax.minY,0.01);
	}

	
	function testTranslateAllPositive() {
		chem.render.Geometry.translateAllPositive(mol);
		for(var i=0,il=mol.countAtoms();i<il;i++){
			var atom=mol.getAtom(i);
			assertTrue(atom.x>=0);
			assertTrue(atom.y>=0);
		}
	}
	function testCreateTransform(){
		chem.render.Geometry.translateAllPositive(mol);
		var renderParams = {
			zoomFactor: 0.8,
			margin: 0.05,
			canvasSize: {
				width: 200,
				height: 400
			}
		};	
		var transform=chem.render.Geometry.createTransform(mol,renderParams);
		for(var i=0,il=mol.countAtoms();i<il;i++){
			var atom=mol.getAtom(i);
			var srcPt=[atom.x,atom.y];
			var dstPt=[];
			transform.transform(srcPt,0,dstPt,0,1);
		/*
			console.debug("X:"+dstPt[0]+"  Y:"+dstPt[1]);
		*/
 			assertTrue((dstPt[0]>0)||(dstPt[0]<renderParams.canvasSize.width));
 			assertTrue((dstPt[1]>0)||(dstPt[0]<renderParams.canvasSize.height));
		}

	}



</script>
</head>
<body>
	
</body>
</html>
